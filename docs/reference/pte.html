<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Panel Treatment Effects — pte • ptetools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Panel Treatment Effects — pte"><meta name="description" content="Tools for estimating treatment effects with panel data.
Main function for computing panel treatment effects"><meta property="og:description" content="Tools for estimating treatment effects with panel data.
Main function for computing panel treatment effects"><meta property="og:image" content="https://github.com/bcallaway11/ptetools/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ptetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/bcallaway11/ptetools"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Panel Treatment Effects</h1>
      <small class="dont-index">Source: <a href="https://github.com/bcallaway11/ptetools/blob/HEAD/R/imports.R"><code>R/imports.R</code></a>, <a href="https://github.com/bcallaway11/ptetools/blob/HEAD/R/pte.R"><code>R/pte.R</code></a></small>
      <div class="d-none name"><code>pte.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Tools for estimating treatment effects with panel data.</p>
<p>Main function for computing panel treatment effects</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pte</span><span class="op">(</span></span>
<span>  <span class="va">yname</span>,</span>
<span>  <span class="va">gname</span>,</span>
<span>  <span class="va">tname</span>,</span>
<span>  <span class="va">idname</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">setup_pte_fun</span>,</span>
<span>  <span class="va">subset_fun</span>,</span>
<span>  <span class="va">attgt_fun</span>,</span>
<span>  cband <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alp <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  boot_type <span class="op">=</span> <span class="st">"multiplier"</span>,</span>
<span>  weightsname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gt_type <span class="op">=</span> <span class="st">"att"</span>,</span>
<span>  ret_quantile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global_fun <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time_period_fun <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_fun <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  process_dtt_gt_fun <span class="op">=</span> <span class="va">process_dtt_gt</span>,</span>
<span>  process_dose_gt_fun <span class="op">=</span> <span class="va">process_dose_gt</span>,</span>
<span>  biters <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cl <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  call <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-yname">yname<a class="anchor" aria-label="anchor" href="#arg-yname"></a></dt>
<dd><p>Name of outcome in <code>data</code></p></dd>


<dt id="arg-gname">gname<a class="anchor" aria-label="anchor" href="#arg-gname"></a></dt>
<dd><p>Name of group in <code>data</code></p></dd>


<dt id="arg-tname">tname<a class="anchor" aria-label="anchor" href="#arg-tname"></a></dt>
<dd><p>Name of time period in <code>data</code></p></dd>


<dt id="arg-idname">idname<a class="anchor" aria-label="anchor" href="#arg-idname"></a></dt>
<dd><p>Name of id in <code>data</code></p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>balanced panel data</p></dd>


<dt id="arg-setup-pte-fun">setup_pte_fun<a class="anchor" aria-label="anchor" href="#arg-setup-pte-fun"></a></dt>
<dd><p>This is a function that should take in <code>data</code>,
<code>yname</code> (the name of the outcome variable in <code>data</code>),
<code>gname</code> (the name of the group variable),
<code>idname</code> (the name of the id variable),
and possibly other arguments such as the significance level <code>alp</code>,
the number of bootstrap iterations <code>biters</code>, and how many clusters
for parallel computing in the bootstrap <code>cl</code>.  The key thing that
needs to be figured out in this function is which groups and time periods
ATT(g,t) should be computed in.  The function should
return a <code>pte_params</code> object which contains all of the parameters
passed into the function as well as <code>glist</code> and <code>tlist</code> which
should be ordered lists of groups and time periods for ATT(g,t) to be computed.</p>
<p>This function provides also provides a good place for error handling related
to the types of data that can be handled.</p>
<p>The <code>pte</code> package contains the function <code>setup_pte</code> that is
a lightweight function that basically just takes the data, omits
the never-treated group from <code>glist</code> but includes all other groups
and drops the first time period.  This works in cases where ATT would
be identified in the 2x2 case (i.e., where there are two time periods,
no units are treated in the first period and the identification strategy
"works" with access to a treated and untreated group and untreated
potential outcomes for both groups in the first period) — for example,
this approach works if DID is the identification strategy.</p></dd>


<dt id="arg-subset-fun">subset_fun<a class="anchor" aria-label="anchor" href="#arg-subset-fun"></a></dt>
<dd><p>This is a function that should take in <code>data</code>,
<code>g</code> (for group), <code>tp</code> (for time period), and <code>...</code>
and be able to return the appropriate <code>data.frame</code> that can be used
by <code>attgt_fun</code> to produce ATT(g=g,t=tp).  The data frame should
be constructed using <code>gt_data_frame</code> in order to guarantee that
it has the appropriate columns that identify which group an observation
belongs to, etc.</p></dd>


<dt id="arg-attgt-fun">attgt_fun<a class="anchor" aria-label="anchor" href="#arg-attgt-fun"></a></dt>
<dd><p>This is a function that should work in the case where
there is a single group and the "right" number of time periods to
recover an estimate of the ATT.  For example, in the contest of
difference in differences, it would need to work for a single group,
find the appropriate comparison group (untreated units), find the right
time periods (pre- and post-treatment), and then recover an estimate
of ATT for that group.  It will be called over and over separately
by groups and by time periods to compute ATT(g,t)'s.</p>
<p>The function needs to work in a very specific way.  It should take in the
arguments: <code>data</code>, <code>...</code>.  <code>data</code> should be constructed
using the function <code>gt_data_frame</code> which checks to make sure
that <code>data</code> has the correct columns defined.
<code>...</code> are additional arguments (such as
formulas for covariates) that <code>attgt_fun</code> needs.  From these arguments
<code>attgt_fun</code> must return a list with element <code>ATT</code> containing the
group-time average treatment effect for that group and that time period.</p>
<p>If <code>attgt_fun</code> returns an influence function (which should be provided
in a list element named <code>inf_func</code>), then the code will use the
multiplier bootstrap to compute standard errors for group-time average
treatment effects, an overall treatment effect parameter, and a dynamic
treatment effect parameter (i.e., event study parameter).  If
<code>attgt_fun</code> does not return an influence function, then the same
objects will be computed using the empirical bootstrap.  This is usually
(perhaps substantially) easier to code, but also will usually be (perhaps
substantially) computationally slower.</p></dd>


<dt id="arg-cband">cband<a class="anchor" aria-label="anchor" href="#arg-cband"></a></dt>
<dd><p>whether or not to report a uniform (instead of pointwise)
confidence band (default is TRUE)</p></dd>


<dt id="arg-alp">alp<a class="anchor" aria-label="anchor" href="#arg-alp"></a></dt>
<dd><p>significance level; default is 0.05</p></dd>


<dt id="arg-boot-type">boot_type<a class="anchor" aria-label="anchor" href="#arg-boot-type"></a></dt>
<dd><p>should be one of "multiplier" (the default) or "empirical".
The multiplier bootstrap is generally much faster, but <code>attgt_fun</code> needs
to provide an expression for the influence function (which could be challenging
to figure out).  If no influence function is provided, then the <code>pte</code>
package will use the empirical bootstrap no matter what the value of this
parameter.</p></dd>


<dt id="arg-weightsname">weightsname<a class="anchor" aria-label="anchor" href="#arg-weightsname"></a></dt>
<dd><p>The name of the column that contains sampling weights.
The default is NULL, in which case no sampling weights are used.</p></dd>


<dt id="arg-gt-type">gt_type<a class="anchor" aria-label="anchor" href="#arg-gt-type"></a></dt>
<dd><p>which type of group-time effects are computed.
The default is "att".  Different estimation strategies can implement
their own choices for <code>gt_type</code></p></dd>


<dt id="arg-ret-quantile">ret_quantile<a class="anchor" aria-label="anchor" href="#arg-ret-quantile"></a></dt>
<dd><p>For functions that compute quantile treatment effects,
this is a specific quantile at which to report results, e.g.,
<code>ret_quantile = 0.5</code> will return that the qte at the median.</p></dd>


<dt id="arg-global-fun">global_fun<a class="anchor" aria-label="anchor" href="#arg-global-fun"></a></dt>
<dd><p>Logical indicating whether or not untreated potential
outcomes can be estimated in one shot, i.e., for all groups and time periods.
Main use case would be for one-shot imputation estimators.  Not supported yet.</p></dd>


<dt id="arg-time-period-fun">time_period_fun<a class="anchor" aria-label="anchor" href="#arg-time-period-fun"></a></dt>
<dd><p>Logical indicating whether or not untreated potential
outcomes can be estimated for all groups in the same time period.  Not supported yet.</p></dd>


<dt id="arg-group-fun">group_fun<a class="anchor" aria-label="anchor" href="#arg-group-fun"></a></dt>
<dd><p>Logical indicating whether or not untreated potential outcomes
can be estimated for all time periods for a single group.  Not supported yet.
These functions aim at reducing or eliminating running the same code multiple times.</p></dd>


<dt id="arg-process-dtt-gt-fun">process_dtt_gt_fun<a class="anchor" aria-label="anchor" href="#arg-process-dtt-gt-fun"></a></dt>
<dd><p>An optional function to customize results when
the gt-specific function returns the distribution of treated and untreated
potential outcomes.  The default is <code>process_dtt_gt</code>, which is a function
provided by the package.  See that function for an example of what this function
should return.  This is unused is unused except in cases where
the results involve distributions.</p></dd>


<dt id="arg-process-dose-gt-fun">process_dose_gt_fun<a class="anchor" aria-label="anchor" href="#arg-process-dose-gt-fun"></a></dt>
<dd><p>An optional function to customize results when the gt-specific
function returns treatment effects that depend on dose (i.e., amount of the
treatment).  The default is <code>process_dose_gt</code>, which is a function provided
by the package.  See that function for an example of what this function should
return.  This is unused except in cases where the results involve doses.</p></dd>


<dt id="arg-biters">biters<a class="anchor" aria-label="anchor" href="#arg-biters"></a></dt>
<dd><p>number of bootstrap iterations; default is 100</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>number of clusters to be used when bootstrapping; default is 1</p></dd>


<dt id="arg-call">call<a class="anchor" aria-label="anchor" href="#arg-call"></a></dt>
<dd><p>keeps track of through the <code>call</code> from external functions/packages</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra arguments that can be passed to create the correct subsets
of the data (depending on <code>subset_fun</code>), to estimate group time
average treatment effects (depending on <code>attgt_fun</code>), or to
aggregating treatment effects (particularly useful are <code>min_e</code>,
<code>max_e</code>, and <code>balance_e</code> arguments to event study aggregations)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>pte_results</code> object</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://github.com/bcallaway11/ptetools">https://github.com/bcallaway11/ptetools</a></p></li>
<li><p>Report bugs at <a href="https://github.com/bcallaway11/ptetools/issues">https://github.com/bcallaway11/ptetools/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Brantly Callaway <a href="mailto:brantly.callaway@uga.edu">brantly.callaway@uga.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example using minimum wage data</span></span></span>
<span class="r-in"><span><span class="co"># and difference-in-differences identification strategy</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bcallaway11.github.io/did/" class="external-link">did</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mpdta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">did_res</span> <span class="op">&lt;-</span> <span class="fu">pte</span><span class="op">(</span></span></span>
<span class="r-in"><span>  yname <span class="op">=</span> <span class="st">"lemp"</span>,</span></span>
<span class="r-in"><span>  gname <span class="op">=</span> <span class="st">"first.treat"</span>,</span></span>
<span class="r-in"><span>  tname <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>  idname <span class="op">=</span> <span class="st">"countyreal"</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">mpdta</span>,</span></span>
<span class="r-in"><span>  setup_pte_fun <span class="op">=</span> <span class="va">setup_pte</span>,</span></span>
<span class="r-in"><span>  subset_fun <span class="op">=</span> <span class="va">two_by_two_subset</span>,</span></span>
<span class="r-in"><span>  attgt_fun <span class="op">=</span> <span class="va">did_attgt</span>,</span></span>
<span class="r-in"><span>  xformla <span class="op">=</span> <span class="op">~</span><span class="va">lpop</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>critical value for uniform confidence band is somehow smaller than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             critical value for pointwise confidence interval...using pointwise</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             confidence interal</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">did_res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall ATT:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ATT    Std. Error     [ 95%  Conf. Int.]  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0305        0.0118    -0.0535     -0.0074 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dynamic Effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Event Time Estimate Std. Error   [95%  Conf. Band]  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -3   0.0298     0.0167 -0.0086      0.0681  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -2  -0.0024     0.0120 -0.0300      0.0251  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1  -0.0243     0.0105 -0.0484     -0.0001 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           0  -0.0189     0.0148 -0.0529      0.0150  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1  -0.0536     0.0171 -0.0928     -0.0144 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           2  -0.1363     0.0378 -0.2228     -0.0497 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           3  -0.1008     0.0402 -0.1928     -0.0089 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes: `*' confidence band does not cover 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="ggpte.html">ggpte</a></span><span class="op">(</span><span class="va">did_res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pte-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brantly Callaway.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

